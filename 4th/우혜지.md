# Chapter06 객체 지도

<br>

> **기능이 아니라 구조를 기반으로 모델을 구축하는 편이 좀 더 범용적이고 이해하기 쉬우며 변경에 안정적이다.
기능을 중심으로 구조를 종속시키는 접근법은 범용적이지 않고 재사용이 불가능하며 변경에 취약한 모델을 낳게 된다.**
> 

<br>

## 기능 설계 vs 구조 설계

- 기능(function) 설계 : 제품이 사용자를 위해 **무엇을 할 수 있는지**에 초점
- 구조(structure) 설계 : 제품의 **형태가 어떠해야** 하는지에 초점
- 소프트웨어를 개발하는 초기 단계에서는 사용자가 무엇을 원하는지, 그리고 사용자가 원하는 것을 만족시키기 위해 시스템이 어떤 기능을 제공해야 하는지에 초점을 맞춰야 한다.
- 성공적인 소프트웨어들이 지닌 공통적인 특징 : 훌륭한 기능 제공과 동시에 사용자가 원하는 새로운 기능을 빠르고 안정적으로 추가할 수 있다.
- 소프트웨어 분야에서 예외가 없는 유일한 규칙은 요구사항이 항상 변경된다는 것
설계라는 행위를 중요하게 만드는 것은 **변경에 대한 필요성**이다.
- 미래에 대비하는 가장 좋은 방법 : **변경을 수용할 수 있는 선택의 여지를 설계에 마련해 놓는 것**

<br>

## 두 가지 재료 : 기능과 구조

- 객체지향을 구축하기 위해서는 사용자에게 제공할 ‘기능’과 기능을 담을 안정적인 ‘구조’라는 재료가 준비돼 있어야 한다.
- **유스케이스 모델링** : 기능을 수집하고 표현하기 위한 기법
- **도메인 모델링** : 구조를 수집하고 표현하기 위한 기법
- 두 가지 모델링 활동의 결과물 : **유스케이스와 도메인 모델**

### 안정적인 재료 : 구조

**도메인 모델**

- **도메인(domain)** : 사용자가 프로그램을 사용하는 대상 분야
- **도메인 모델** : 사용자가 프로그램을 사용하는 대상 영역에 관한 지식을 선택적으로 **단순화**하고 의식적으로 **구조화**한 형태
- 도메인 모델은 단순히 다이어그램이 아니라, 소프트웨어에 대한 멘탈 모델(Mental Model)이다.

**도메인의 모습을 담을 수 있는 객체지향**

- 최종 코드는 사용자가 도메인을 바라보는 관점을 반영해야 한다.
즉, 애플리케이션이 도메인 모델을 기반으로 설계돼야 한다.
- 객체지향을 이용하면 도메인에 대한 사용자 모델, 디자인 모델, 시스템 이미지  모두가 유사한 모습을 유지하도록 만드는 것이 가능하다. ⇒ **연결완전성** or **표현적 차이**

**표현적 차이**

- 소프트웨어 객체와 현실 객체 사이의 의미적 거리
- 소프트웨어 객체는 현실 객체를 모방한 것이 아니라 은유를 기반으로 재창조한 것이다.
- 소프트웨어 객체를 창조하기 위해 우리가 **은유**해야 하는 대상은 **도메인 모델**이다.
- 도메인 모델을 기반으로 설계하고 구현하는 것은 사용자가 도메인을 바라보는 관점을 그대로 코드에 반영할 수 있게 한다.
- 표현적 차이가 중요한 이유는 소프트웨어를 이해하고 수정하기 쉽게 만들어주기 때문이다.

**불안정한 기능을 담는 안정적인 도메인 모델**

- 도메인 모델을 기반으로 코드를 작성하는 이유 중 하나는 도메인 모델이 제공하는 **구조가 상대적으로 안정적**이기 때문이다.
- 도메인 모델의 핵심은 **사용자가 도메인을 바라보는 관점을 반영**해 소프트웨어를 설계하고 구현하는 것이다.
- 소프트웨어 개발의 가장 큰 적은 **변경**이며 변경은 항상 발생한다.
- 도메인 모델이 도메인과 관련된 중요한 개념과 관계를 보여준다고 해도 실제로 사용자에게 중요한 것은 도메인 모델이 아닌 **소프트웨어의 기능**이다.

### 불안정한 재료: 기능

**유스케이스**

- 사용자의 목표를 달성하기 위해 사용자와 시스템 간에 이뤄지는 상호작용의 흐름을 텍스트로 정리한 것
- 유스케이스의 가치는 사용자들의 목표를 중심으로 시스템의 기능적인 요구사항들을 이야기 형식으로 묶을 수 있다는 점이다.

**유스케이스의 특성**

1. 유스케이스는 사용자와 시스템 간의 상호작용을 보여주는 ‘텍스트’이다.
2. 유스케이스는 하나의 시나리오가 아니라 여러 시나리오들의 집합이다.
3. 유스케이스는 단순한 피처(feature) 목록과 다르다.
4. 유스케이스는 사용자 인터페이스와 관련된 세부 정보를 포함하지 말아야 한다.
5. 유스케이스는 내부 설계와 관련된 정보를 포함하지 않는다.

**유스케이스는 설계 기법도, 객체지향 기법도 아니다**

- 유스케이스는 시스템의 내부 구조나 실행 메커니즘에 관한 어떤 정보도 제공하지 않는다.
- 시스템이 외부에 제공해야 하는 행위만 포함한다.
- 텍스트 안에서 도메인 모델에서 사용할 용어에 대한 힌트를 얻을 수는 있다.

<br>

## 재료 합치기: 기능과 구조의 통합

### 도메인 모델, 유스케이스, 그리고 책임-주도 설계

- 불안정한 기능을 안정적인 구조 안에 담음으로써 변경에 대한 파급효과를 최소화하는 것은 훌륭한 객체지향 설계자가 갖춰야 할 기본적인 설계 능력이다.
- 프로그래머는 시스템을 사용자로부터 전송된 메시지를 수행하기 위해 책임을 수행하는 거대한 자율적인 객체로 본다.
- 협력의 출발을 장식하는 첫 번째 메시지는 시스템의 기능을 시스템의 책임으로 바꾼 후 얻어진 것이다.
- 각각의 기능
    - **유스케이스** : 사용자에게 제공할 기능을 시스템의 책임으로 보게 함으로써 객체 간의 안정적인 구조에 책임을 분배할 수 있는 출발점 제공
    - **도메인 모델** : 기능을 수용하기 위해 은유할 수 있는 안정적인 구조 제공
    - **책임-주도 설계** : 유스케이스로부터 첫 번째 메시지와 사용자가 달성하려는 목표를, 도메인 모델로부터 기능을 수용할 수 있는 안정적인 구조를 제공받아 실제로 동작하는 객체들의 협력 공동체를 창조

> **견고한 객체지향 애플리케이션을 개발하기 위해서는 사용자의 관점에서 시스템의 기능을 명시하고, 
사용자와 설계자가 공유하는 안정적인 구조를 기반으로 기능을 책임으로 변환하는 체계적인 절차를 따라야 한다는 것이다.**
> 
- 책임할당의 기본 원칙은 책임을 수행하는 데 필요한 정보를 가진 객체에게 그 책임을 할당하는 것
- 유스케이스에서 출발해 객체들의 협력으로 이어지는 일련의 흐름은 객체 안에 다른 객체를 포함하는 **재귀적 합성**이라는 객체지향의 기본 개념을 잘 보여준다.

**기능 변경을 흡수하는 안정적인 구조**

- 기능이 변경되거나 새롭게 추가돼도 대부분의 클래스 구조가 그대로 유지되는 이유는 도메인을 구성하는 기본적인 개념과 관계를 포함하는 도메인 모델을 기반으로 시스템의 기능을 대응시켰기 때문이다.
- **연결완전성** : 도메인 모델링에서 사용한 객체와 개념을 프로그래밍 설계에서의 객체와 클래스로 매끄럽게 변환할 수 있다. (모델 → 코드)
- 객체지향이 강력한 이유는 **연결완전성의 역방향 역시 성립**한다는 것이다.
    - 코드의 변경으로부터 도메인 모델의 변경 사항을 유추할 수 있다.
- **가역성(reversibility)** : 코드에서 모델로의 매끄러운 흐름을 의미
